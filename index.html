<!doctype HTML>
<html>
  <head>
      <meta name="author" content="Todor Stoev">
      <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0'>
      <meta name="apple-mobile-web-app-capable" content="yes">
      <style>
        body {
          width: 100vw;
          height: 100vh;
        }
        .buttons-wrapper {
          height: 0;
          position: fixed;
          align-items: center;
          justify-content: space-evenly;
          bottom:0;
          left: 0;
          background: #fff3;
          display: flex;
          width: 100%;
          z-index: 20;
          overflow: hidden;
          transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .buttons-wrapper.visible {
          height: 14vh;
        }
        .button {
          background: linear-gradient(to right, rgb(127, 127, 213), rgb(134, 168, 231), rgb(145, 234, 228));
          border-radius: 360px;
          border:none;
          z-index: 30;
          width: 10vh;
          position: relative;
          height: 10vh;
          -webkit-box-shadow: 0 10px 6px -6px #777;
          -moz-box-shadow: 0 10px 6px -6px #777;
          box-shadow: 0 10px 6px -6px #777;
          -webkit-transition-property: background -webkit-transform color;
          -webkit-transition-duration: 0.5s;
          -webkit-transition-timing-function: linear;
          transition-property: background -webkit-transform color;
          transition-duration: 0.5s;
          transition-timing-function: linear;
        }
      
        .volume.muted:before {
          content: url('icons/volume-mute-solid.svg');
          width:60%;
          position: absolute;
          margin-left: auto;
          margin-right: auto;
          left: 0;
          right: 0;
          top:20%;
        }
        .volume.unmuted:before {
          content: url('icons/volume-up-solid.svg');
          width:60%;
          position: absolute;
          margin-left: auto;
          margin-right: auto;
          left: 0;
          right: 0;
          top:22%;
          /* background: center / 70% no-repeat url('./volume-up-solid.svg') ; */
        }
        .play.playing:before {
          content: url('icons/pause-solid.svg');
          width:40%;
          position: absolute;
          margin-left: auto;
          margin-right: auto;
          left: 0;
          right: 0;
          top:27%;
        }
        .play.paused:before {
          content: url('icons/play-solid.svg');
          width:40%;
          position: absolute;
          margin-left: auto;
          margin-right: auto;
          left: 10px;
          right: 0;
           top: 27%;
          /* background: center / 70% no-repeat url('./volume-up-solid.svg') ; */
        }
      </style>
  </head>
<script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/dev/aframe/build/aframe-ar.js"></script>

  <body style='margin : 0px; overflow: hidden;'>
    <div class="buttons-wrapper">
      <button class="button play paused"></button>
      <button class="button volume muted"></button>
    </div>
    <a-scene embedded arjs='sourceType: webcam; detectionMode: mono; trackingMethod: best;debugUIEnabled: false;' vr-mode-ui="enabled: false">

      <a-assets>
          <video crossOrigin="anonymous" preload="none" playsinline  id="vid" type="video/mp4" poster="icons/thumb.jpg" src="preflight.mp4">
      </a-assets>
      <a-marker  cursor="rayOrigin: mouse"  id="animated-marker" preset='custom' type='pattern' url='./pattern-marker.patt'  >
          <a-video id="animated-model" src="#vid" width="1.78" height="1" rotation="270 0 0" play="false"></a-video>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>

            // var body = document.querySelector("body");
            var video = document.querySelector('#vid');
            var mark = document.querySelector("a-marker");
            var muteIcon = document.querySelector('.volume');
            var playIcon = document.querySelector('.play');
            var butWrapper = document.querySelector('.buttons-wrapper');


            playIcon.addEventListener('click',()=>{
              if(!video.paused) {
                video.pause();
                playIcon.classList.remove('playing')
                playIcon.classList.add('paused')
              }else {
                video.play();
                playIcon.classList.remove('paused')
                playIcon.classList.add('playing')
              }
            },{passive:true})



            muteIcon.addEventListener('click',(e)=>{
                if( video.muted ) {
                  video.muted = false;
                  muteIcon.classList.remove('muted')
                  muteIcon.classList.add('unmuted')
                }else {
                  video.muted = true;
                  muteIcon.classList.remove('unmuted')
                  muteIcon.classList.add('muted')
                }
            },{passive:true})

            mark.addEventListener("markerFound", (e)=>{
              // video.play();
              butWrapper.classList.add('visible');
            },{passive:true})

            mark.addEventListener("markerLost", (e)=>{
              video.pause();
              playIcon.classList.remove('playing')
              playIcon.classList.add('paused')
              butWrapper.classList.remove('visible');
            },{passive:true})

    </script>
  </body>
</html>